{"id":"clarigen-qfp","title":"Add devnet network support and move tx builder data fetching to client-side","description":"Enable 'devnet' network option and convert server-side data loading in tx builder page to client-side fetching. This will allow using localhost-based networks by moving getContractAbi calls and function resolution from the route loader to React components.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-16T21:06:55.715779-08:00","updated_at":"2025-12-16T21:16:08.651676-08:00","closed_at":"2025-12-16T21:16:08.651676-08:00","close_reason":"Moved tx builder route to client-side TanStack Query fetching and enabled devnet network support with localhost API base."}
{"id":"clarigen-t3p","title":"Transaction Builder Feature","description":"Build a dynamic transaction builder for Stacks smart contracts.\n\nFeature allows users to:\n1. Navigate to /tx/:network/:contractAddress/:functionName\n2. See a dynamically generated form based on the contract's ABI\n3. Fill in function arguments with type-appropriate inputs\n4. Connect wallet and sign transactions (future)\n\nKey technical details:\n- Multi-network support (mainnet/testnet)\n- Form fields for all Clarity types (int, uint, bool, principal, buffers, strings, optionals, lists, tuples)\n- URL state persistence for shareable tx links\n- Integration with @stacks/connect for wallet connection\n\nPlanning doc: web/history/tx-builder-plan.md","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-16T17:56:38.377904-08:00","updated_at":"2025-12-16T17:58:36.751778-08:00"}
{"id":"clarigen-t3p.1","title":"Setup tx builder route with param validation","description":"Create TanStack Router route at /tx/$network.$contractAddress.$functionName.tsx\n\nRoute params:\n- network: 'mainnet' | 'testnet' (validate using constants.ts Network type)\n- contractAddress: Stacks contract ID like 'SP120SBRBQJ00MCWS7TM5R8WJNTTKD5K0HFRC2CNE.usdcx-v1'\n- functionName: Name of the function to call\n\nImplementation:\n1. Create file at web/src/routes/tx/$network.$contractAddress.$functionName.tsx\n2. Use createFileRoute with loader for server-side data fetching\n3. Validate network param, throw notFound() if invalid\n4. Parse and validate contractAddress format (should contain exactly one '.')\n5. Basic page scaffold that displays the params\n\nSee web/src/routes/__root.tsx and web/src/routes/index.tsx for existing patterns.\nTanStack Router docs: file-based routing with $param syntax.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T17:56:43.735675-08:00","updated_at":"2025-12-16T18:09:51.058566-08:00","closed_at":"2025-12-16T18:09:51.058566-08:00","close_reason":"Route created at `web/src/routes/tx.$network.$contractAddress.$functionName.tsx`. Validates network (mainnet/testnet), contract address format, and function existence in ABI. Fetches ABI in loader, displays function args. See `web/history/tx-builder-progress.md` for full details.","dependencies":[{"issue_id":"clarigen-t3p.1","depends_on_id":"clarigen-t3p","type":"parent-child","created_at":"2025-12-16T17:56:43.743803-08:00","created_by":"daemon"}]}
{"id":"clarigen-t3p.2","title":"Fetch contract ABI and function metadata","description":"Create TanStack Query hook to fetch contract ABI and extract function info.\n\nExisting infrastructure:\n- web/src/lib/stacks-api.ts has getContractAbi(network, contractId) already implemented\n- Returns ClarityAbi from @stacks/transactions (see packages/core/src/abi-types.ts for detailed types)\n\nImplementation:\n1. Create web/src/hooks/use-contract-abi.ts\n2. Export useContractAbi(network, contractId) hook using @tanstack/react-query\n3. Export useContractFunction(network, contractId, functionName) that:\n   - Uses useContractAbi internally\n   - Finds the function by name from abi.functions array\n   - Returns { function: ClarityAbiFunction | undefined, isLoading, error }\n4. Handle errors: contract not found, function not found\n5. Function has access type ('public' | 'read_only' | 'private') - filter to public/read_only\n\nClarityAbiFunction structure:\n{\n  name: string;\n  access: 'private' | 'public' | 'read_only';\n  args: Array\u003c{ name: string; type: ClarityAbiType }\u003e;\n  outputs: { type: ClarityAbiType };\n}","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T17:57:05.860765-08:00","updated_at":"2025-12-16T18:12:47.071098-08:00","closed_at":"2025-12-16T18:12:47.071098-08:00","close_reason":"Implemented TanStack Query hooks: useContractAbi, useContractFunction, useContractFunctions","dependencies":[{"issue_id":"clarigen-t3p.2","depends_on_id":"clarigen-t3p","type":"parent-child","created_at":"2025-12-16T17:57:05.864742-08:00","created_by":"daemon"}]}
{"id":"clarigen-t3p.3","title":"Build Clarity type form field components","description":"Create form input components for each Clarity type. This is the core of the tx builder.\n\nDirectory: web/src/components/tx-builder/fields/\n\nType → Component mapping:\n- uint128, int128 → NumberField (text input, validate numeric, convert to bigint)\n- bool → BoolField (use existing Switch component)\n- principal → PrincipalField (text input, validate Stacks address format SP.../ST...)\n- trait_reference → TraitField (text input, validate contract principal format addr.contract)\n- (buff N) → BufferField (hex input, use viem fromHex/toHex, validate byte length)\n- (string-ascii N) → StringAsciiField (text input, validate ASCII chars + max length)\n- (string-utf8 N) → StringUtf8Field (text input, validate max length)\n- (optional T) → OptionalField (toggle for none + recursive child field)\n- (list N T) → ListField (add/remove buttons + array of recursive child fields)\n- (tuple {...}) → TupleField (nested group of fields for each tuple member)\n\nCreate main dispatcher: web/src/components/tx-builder/clarity-field.tsx\n- Takes ClarityAbiType and renders appropriate field component\n- Recursive for nested types (optional, list, tuple)\n\nUse type checkers from packages/core/src/clarity-types.ts:\n- isClarityAbiPrimitive, isClarityAbiBuffer, isClarityAbiOptional, etc.\n\nFollow existing form component patterns in web/src/components/form-components.tsx.\nUse useFieldContext from @tanstack/react-form.\n\nFor buffers, install viem if not present: pnpm add viem -F web","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T17:57:18.222522-08:00","updated_at":"2025-12-16T19:07:02.83071-08:00","closed_at":"2025-12-16T19:07:02.83071-08:00","close_reason":"Implemented Clarity type form field components: ClarityField dispatcher + 10 field components (NumberField, BoolField, PrincipalField, BufferField, StringAsciiField, StringUtf8Field, OptionalField, ListField, TupleField). Integrated with tx route using TanStack Form.","dependencies":[{"issue_id":"clarigen-t3p.3","depends_on_id":"clarigen-t3p","type":"parent-child","created_at":"2025-12-16T17:57:18.227889-08:00","created_by":"daemon"}]}
{"id":"clarigen-t3p.4","title":"Create dynamic transaction form component","description":"Build the main transaction form that dynamically generates fields from function ABI.\n\nFile: web/src/components/tx-builder/tx-form.tsx\n\nImplementation:\n1. Accept props: { func: ClarityAbiFunction, contractId: string, network: NETWORK }\n2. Use useAppForm from web/src/hooks/form.ts with dynamic default values\n3. For each func.args, render a ClarityField component\n4. Generate default values object from args (empty strings, false for bool, etc.)\n5. On submit, use parseToCV from @clarigen/core to convert each value to ClarityValue\n6. For now, just console.log the converted values (actual tx comes later)\n\nForm value structure mirrors args:\n{ argName1: value1, argName2: value2, ... }\n\nFor nested types (tuple, list), values are nested accordingly:\n{ myTuple: { field1: 'value', field2: 123 }, myList: ['a', 'b'] }\n\nUse parseToCV(value, argType) from packages/core/src/clarity-types.ts to convert.\nHandle conversion errors gracefully with user feedback.\n\nIntegrate into the route component from task 1.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T17:57:44.805996-08:00","updated_at":"2025-12-17T06:20:24.483868-08:00","closed_at":"2025-12-17T06:20:24.483868-08:00","close_reason":"Form component already implemented - see TxBuilderForm in tx.$network.$contractAddress.$functionName.tsx","dependencies":[{"issue_id":"clarigen-t3p.4","depends_on_id":"clarigen-t3p","type":"parent-child","created_at":"2025-12-16T17:57:44.807999-08:00","created_by":"daemon"}]}
{"id":"clarigen-t3p.5","title":"Integrate Stacks wallet connection","description":"Add wallet connection using @stacks/connect.\n\nReference: https://docs.stacks.co/stacks-connect/connect-wallet\n\nInstallation: pnpm add @stacks/connect -F web\n\nImplementation:\n1. Create web/src/lib/stacks-wallet.ts with wallet configuration:\n   - AppConfig with ['store_write'] permission\n   - UserSession instance\n   - Helper functions: connectWallet(), disconnectWallet(), isConnected()\n\n2. Create web/src/hooks/use-stacks-wallet.ts:\n   - useStacksWallet() hook returning { address, isConnected, connect, disconnect }\n   - Persist session across page loads\n\n3. Create web/src/components/wallet-button.tsx:\n   - Shows 'Connect Wallet' when disconnected\n   - Shows truncated address + 'Disconnect' when connected\n   - Use existing Button component\n\n4. Add WalletButton to header or tx builder page\n\nshowConnect usage:\nimport { showConnect, AppConfig, UserSession } from '@stacks/connect';\n\nconst appConfig = new AppConfig(['store_write']);\nconst userSession = new UserSession({ appConfig });\n\nshowConnect({\n  appDetails: { name: 'Clarigen Tools', icon: '/favicon.ico' },\n  onFinish: () =\u003e { /* refresh state */ },\n  userSession,\n});\n\nGet address: userSession.loadUserData().profile.stxAddress.mainnet (or testnet)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T17:58:09.575639-08:00","updated_at":"2025-12-16T20:41:42.36046-08:00","closed_at":"2025-12-16T20:41:42.36046-08:00","close_reason":"Completed wallet auth integration with @stacks/connect","dependencies":[{"issue_id":"clarigen-t3p.5","depends_on_id":"clarigen-t3p","type":"parent-child","created_at":"2025-12-16T17:58:09.579754-08:00","created_by":"daemon"}]}
{"id":"clarigen-t3p.6","title":"Add URL state management with nuqs","description":"Persist form state in URL query params for shareability using nuqs.\n\nInstallation: pnpm add nuqs -F web\n\nGoal: Form values should sync to URL so users can share pre-filled tx links:\n/tx/mainnet/SP.../transfer?amount=1000\u0026recipient=SP...\n\nImplementation:\n1. Setup nuqs with TanStack Router (check nuqs docs for integration)\n2. Create custom hook: useUrlFormState(args: ClarityAbiArg[])\n   - Generates useQueryState calls for each argument\n   - Handles serialization/deserialization based on Clarity type\n3. Sync form state bidirectionally with URL params\n4. Handle complex types (tuples, lists) with JSON serialization\n\nSerialization strategy:\n- Primitives (uint, int, bool, strings): direct string representation\n- Buffers: hex string (no 0x prefix)\n- Optional: 'none' string or value\n- Lists/Tuples: JSON.stringify\n\nnuqs basic usage:\nimport { useQueryState, parseAsString, parseAsJson } from 'nuqs'\n\nconst [value, setValue] = useQueryState('key', parseAsString)\n\nConsider: nuqs may need adapter for TanStack Router - check docs.\nAlternative: use TanStack Router's built-in search params if nuqs integration is complex.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T17:58:25.592783-08:00","updated_at":"2025-12-17T06:27:54.119884-08:00","closed_at":"2025-12-17T06:27:54.119884-08:00","close_reason":"Implemented URL state management with nuqs - form values sync bidirectionally with URL query params","dependencies":[{"issue_id":"clarigen-t3p.6","depends_on_id":"clarigen-t3p","type":"parent-child","created_at":"2025-12-16T17:58:25.597039-08:00","created_by":"daemon"}]}
